<!DOCTYPE html><!DOCTYPE html>

<html><html lang="en">

<head><head>

    <title>API Test</title>    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1">    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>    <title>API Test - Frontend Debug</title>

        body {    <style>

            font-family: Arial, sans-serif;        body { font-family: Arial, sans-serif; margin: 20px; }

            max-width: 800px;        .success { color: green; }

            margin: 20px auto;        .error { color: red; }

            padding: 20px;        .info { color: blue; }

            background: #f0f0f0;        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; }

        }    </style>

        .test-section {</head>

            background: white;<body>

            padding: 20px;    <h1>üîß YQPayNow Frontend API Test</h1>

            margin: 20px 0;    <div id="status">Testing API connection...</div>

            border-radius: 8px;    <div id="results"></div>

            box-shadow: 0 2px 4px rgba(0,0,0,0.1);

        }    <script>

        .success { color: green; font-weight: bold; }        const config = {

        .error { color: red; font-weight: bold; }            api: {

        button {                baseUrl: 'http://localhost:5000/api'

            padding: 15px 30px;            }

            margin: 10px 5px;        };

            cursor: pointer;

            background: #6B0E9B;        async function testAPI() {

            color: white;            const statusDiv = document.getElementById('status');

            border: none;            const resultsDiv = document.getElementById('results');

            border-radius: 5px;            

            font-size: 16px;            try {

        }                statusDiv.innerHTML = '<span class="info">üåê Testing theaters API...</span>';

        button:active {                

            background: #4A0B6B;                const response = await fetch(`${config.api.baseUrl}/theaters`);

        }                const data = await response.json();

        pre {                

            background: #f5f5f5;                if (response.ok) {

            padding: 10px;                    statusDiv.innerHTML = '<span class="success">‚úÖ API Connection Successful!</span>';

            border-radius: 4px;                    resultsDiv.innerHTML = `

            overflow-x: auto;                        <h3>API Results:</h3>

            font-size: 12px;                        <p><strong>Status:</strong> ${response.status}</p>

        }                        <p><strong>Number of theaters:</strong> ${data.theaters ? data.theaters.length : 'No theaters key'}</p>

    </style>                        <p><strong>API URL:</strong> ${config.api.baseUrl}/theaters</p>

</head>                        <h4>Sample theaters:</h4>

<body>                        <pre>${JSON.stringify(data.theaters ? data.theaters.slice(0, 3) : data, null, 2)}</pre>

    <h1>üîç API Connection Test</h1>                        <p class="success">üéâ <strong>The frontend API configuration is working correctly!</strong></p>

                            <p class="info">The issue is likely a browser cache problem. Try:</p>

    <div class="test-section">                        <ul>

        <h2>1Ô∏è‚É£ Theater API Test</h2>                            <li>Hard refresh (Ctrl+F5 or Cmd+Shift+R)</li>

        <button onclick="testTheaterAPI()">Test Theater API</button>                            <li>Clear browser cache</li>

        <div id="theater-result"></div>                            <li>Open in incognito/private mode</li>

    </div>                        </ul>

                    `;

    <div class="test-section">                } else {

        <h2>2Ô∏è‚É£ Settings API Test</h2>                    throw new Error(`HTTP ${response.status}: ${data.message || 'Unknown error'}`);

        <button onclick="testSettingsAPI()">Test Settings API</button>                }

        <div id="settings-result"></div>            } catch (error) {

    </div>                statusDiv.innerHTML = '<span class="error">‚ùå API Connection Failed</span>';

                resultsDiv.innerHTML = `

    <div class="test-section">                    <h3>Error Details:</h3>

        <h2>3Ô∏è‚É£ Environment Info</h2>                    <p class="error">${error.message}</p>

        <div id="env-info">                    <p><strong>Attempted URL:</strong> ${config.api.baseUrl}/theaters</p>

            <p><strong>Page URL:</strong> <span id="current-url"></span></p>                    <p class="info">Make sure the backend server is running on port 5000</p>

            <p><strong>API Base:</strong> http://192.168.1.6:5000/api</p>                `;

            <p><strong>Theater ID:</strong> 68ed25e6962cb3e997acc163</p>            }

        </div>        }

    </div>

        // Run test when page loads

    <script>        window.onload = testAPI;

        const API_BASE_URL = 'http://192.168.1.6:5000/api';    </script>

        const THEATER_ID = '68ed25e6962cb3e997acc163';</body>

</html>
        document.getElementById('current-url').textContent = window.location.href;

        async function testTheaterAPI() {
            const resultDiv = document.getElementById('theater-result');
            resultDiv.innerHTML = '<p>‚è≥ Testing...</p>';

            try {
                const url = `${API_BASE_URL}/theaters/${THEATER_ID}`;
                console.log('üé≠ Fetching:', url);
                
                const startTime = Date.now();
                const response = await fetch(url);
                const endTime = Date.now();
                
                console.log('üì° Response:', response.status, 'in', endTime - startTime, 'ms');
                
                const data = await response.json();
                console.log('üì¶ Data:', data);

                if (data.success && data.theater) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ SUCCESS!</p>
                        <p><strong>Theater:</strong> ${data.theater.name}</p>
                        <p><strong>Location:</strong> ${data.theater.location?.city || 'N/A'}</p>
                        <p><strong>Response Time:</strong> ${endTime - startTime}ms</p>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå API Error</p>
                        <p>${data.message || 'Theater not found'}</p>
                        <pre>${JSON.stringify(data, null, 2).substring(0, 500)}</pre>
                    `;
                }
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultDiv.innerHTML = `
                    <p class="error">‚ùå NETWORK ERROR</p>
                    <p><strong>Message:</strong> ${error.message}</p>
                    <p><strong>Type:</strong> ${error.name}</p>
                    <p>This usually means CORS is blocked or the server is unreachable from your device.</p>
                `;
            }
        }

        async function testSettingsAPI() {
            const resultDiv = document.getElementById('settings-result');
            resultDiv.innerHTML = '<p>‚è≥ Testing...</p>';

            try {
                const url = `${API_BASE_URL}/settings/general`;
                console.log('‚öôÔ∏è Fetching:', url);
                
                const response = await fetch(url);
                const data = await response.json();

                if (data.success) {
                    resultDiv.innerHTML = `
                        <p class="success">‚úÖ SUCCESS!</p>
                        <p><strong>App Name:</strong> ${data.data?.config?.applicationName || 'N/A'}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <p class="error">‚ùå Failed</p>
                    `;
                }
            } catch (error) {
                console.error('‚ùå Error:', error);
                resultDiv.innerHTML = `
                    <p class="error">‚ùå NETWORK ERROR</p>
                    <p>${error.message}</p>
                `;
            }
        }
    </script>
</body>
</html>
